[{"path":"https://lcbc-uio.github.io/neuromapr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Athanasia Mo Mowinckel Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"comparing-two-brain-maps","dir":"Articles","previous_headings":"","what":"Comparing two brain maps","title":"Getting Started with neuromapr","text":"core workflow: load data, compare, interpret. simulate two brain maps keep things self-contained, practice read real data GIFTI NIfTI files. Two maps planted correlation around 0.4, plus distance matrix describing spatial layout. simplest comparison: r parametric p tell familiar story. p assumes independence observations—assumption brain violates everywhere.","code":"set.seed(42) n <- 100 coords <- matrix(rnorm(n * 3), ncol = 3) distmat <- as.matrix(dist(coords))  map_a <- rnorm(n) map_b <- 0.4 * map_a + rnorm(n, sd = 0.8) result <- compare_maps(map_a, map_b, verbose = FALSE) result #>  #> ── Brain Map Comparison #> Method: pearson #> r = 0.5302, p = 1.4e-08 #> n = 100"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"adding-a-spatial-null-model","dir":"Articles","previous_headings":"","what":"Adding a spatial null model","title":"Getting Started with neuromapr","text":"get honest p-value, generate surrogate versions map_a preserve spatial autocorrelation, check whether observed correlation unusual correlations surrogates. neuromapr provides eight null model methods. parcellated data distance matrix, variogram matching (burt2020) strong default: p_null value now accounts spatial autocorrelation. remains small, relationship two maps unlikely artifact shared spatial structure.","code":"result_null <- compare_maps(   map_a, map_b,   null_method = \"burt2020\",   distmat = distmat,   n_perm = 500L,   seed = 1,   verbose = FALSE ) result_null #>  #> ── Brain Map Comparison #> Method: pearson #> r = 0.5302, p = 1.4e-08 #> n = 100 #> ──────────────────────────────────────────────────────────────────────────────── #> Null model: burt2020 (500 permutations) #> p_null = 0.002"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"visualising-the-null-distribution","dir":"Articles","previous_headings":"","what":"Visualising the null distribution","title":"Getting Started with neuromapr","text":"comparison object stores null correlations, making straightforward see observed value falls: Null correlations 500 variogram-matching surrogates. dashed red line marks observed correlation. observed correlation sits well outside null distribution, relationship likely genuine. sits inside, spatial autocorrelation alone can explain similarity.","code":"null_df <- data.frame(r = result_null$null_r) obs_r <- result_null$r  ggplot2::ggplot(null_df, ggplot2::aes(x = r)) +   ggplot2::geom_histogram(     bins = 30, fill = \"steelblue\", alpha = 0.7   ) +   ggplot2::geom_vline(     xintercept = obs_r,     linetype = \"dashed\", color = \"red\", linewidth = 1   ) +   ggplot2::labs(     x = \"Null correlation (r)\",     y = \"Count\"   ) +   ggplot2::theme_minimal()"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"pre-computing-null-distributions","dir":"Articles","previous_headings":"","what":"Pre-computing null distributions","title":"Getting Started with neuromapr","text":"Generating nulls expensive part. want compare map several targets, generate reuse: null_distribution object print, summary, plot, .matrix methods. summary gives per-element null means standard deviations. plot method shows null distribution chosen element: Built-plot method null_distribution object. Pass pre-computed object compare_maps(): redundant computation source map appears multiple comparisons.","code":"nulls <- generate_nulls(   map_a,   method = \"moran\",   distmat = distmat,   n_perm = 200L,   seed = 42 ) nulls #>  #> ── Null Distribution #> • Method: moran #> • Permutations: 200 #> • Observations: 100 plot(nulls, parcel = 1L) compare_maps(map_a, map_b, nulls = nulls, verbose = FALSE) #>  #> ── Brain Map Comparison #> Method: pearson #> r = 0.5302, p = 1.4e-08 #> n = 100 #> ──────────────────────────────────────────────────────────────────────────────── #> Null model: moran (200 permutations) #> p_null = 0.00498"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"working-with-real-brain-map-files","dir":"Articles","previous_headings":"","what":"Working with real brain map files","title":"Getting Started with neuromapr","text":"practice, brain maps live disk. compare_maps() read_brain_map_values() accept file paths directly: GIFTI (.func.gii) NIfTI (.nii.gz) formats supported. separate reading step needed.","code":"values <- read_brain_map_values(\"cortical_thickness.func.gii\")  result <- compare_maps(   \"path/to/map_a.func.gii\",   \"path/to/map_b.func.gii\",   null_method = \"moran\",   distmat = distmat )"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"accessing-the-neuromaps-atlas-collection","dir":"Articles","previous_headings":"","what":"Accessing the neuromaps atlas collection","title":"Getting Started with neuromapr","text":"neuromaps project curates registry published brain map annotations—PET receptor maps, gene expression, cortical thickness, . neuromapr provides direct access collection: find annotation want, download : Files cached locally, subsequent calls skip download. registry fetched neuromaps GitHub repository cached session.","code":"neuromaps_available()  neuromaps_available(source = \"beliveau\", tags = \"pet\") paths <- fetch_neuromaps_annotation(   \"abagen\", \"genepc1\", \"fsaverage\",   density = \"10k\" )"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"custom-metrics-with-permtest_metric","dir":"Articles","previous_headings":"","what":"Custom metrics with permtest_metric()","title":"Getting Started with neuromapr","text":"compare_maps() built around correlation. metrics—mean absolute error, cosine similarity, anything takes two vectors returns scalar—permtest_metric() provides null model machinery: Add null_method spatially-constrained surrogates instead random permutation:","code":"mae <- function(a, b) mean(abs(a - b))  result_mae <- permtest_metric(   map_a, rnorm(n),   metric_func = mae,   n_perm = 200L,   seed = 1 ) result_mae$observed #> [1] 1.117007 result_mae$p_value #> [1] 0.6517413 result_spatial <- permtest_metric(   map_a, rnorm(n),   metric_func = mae,   n_perm = 200L,   seed = 1,   null_method = \"burt2020\",   distmat = distmat ) result_spatial$p_value #> [1] 0.8159204"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"choosing-a-null-model","dir":"Articles","previous_headings":"","what":"Choosing a null model","title":"Getting Started with neuromapr","text":"right model depends data: vignette(\"null-models\") walks method detail.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"what-comes-next","dir":"Articles","previous_headings":"","what":"What comes next","title":"Getting Started with neuromapr","text":"vignette covered essential workflow: compare maps, generate spatially-constrained null distributions, interpret results. : vignette(\"null-models\") dives eight null model methods assumptions. vignette(\"parcellation\") covers aggregating vertex data parcels parcel-level null models. vignette(\"surface-geometry\") explains geodesic distances, surface graphs, vertex area calculations.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/neuromapr.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Getting Started with neuromapr","text":"Markello RD, Hansen JY, Liu Z-Q, et al. (2022). neuromaps: structural functional interpretation brain maps. Nature Methods, 19, 1472–1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"the-landscape","dir":"Articles","previous_headings":"","what":"The landscape","title":"Choosing and Using Null Models","text":"eight methods split three families. Distance-based methods work distance matrix—Euclidean, geodesic, custom. coordinate system required, apply equally parcellated vertex-level data. burt2020 — variogram matching burt2018 — spatial autoregressive model moran — Moran spectral randomization Spin-based methods require spherical coordinates (one set per hemisphere) operate vertex-level data. rotate coordinates sphere, reassign values based proximity. alexander_bloch — nearest-neighbour reassignment spin_vasa — greedy sequential assignment spin_hungarian — optimal (Hungarian) assignment Parcel spin methods combine spin rotations parcellation-level reassignment. need spherical coordinates parcellation scheme. baum — maximum-overlap parcel assignment cornblath — majority-vote parcel assignment","code":"set.seed(42) n <- 80 coords_3d <- matrix(rnorm(n * 3), ncol = 3) distmat <- as.matrix(dist(coords_3d))  map_x <- rnorm(n)"},{"path":[]},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"variogram-matching-burt2020","dir":"Articles","previous_headings":"Distance-based methods","what":"Variogram matching (burt2020)","title":"Choosing and Using Null Models","text":"Burt et al. (2020) generate surrogates randomly permuting original values, smoothing different spatial scales selecting surrogate whose variogram best matches original. result map rank-order distribution approximately distance-dependent spatial structure. Variogram matching general-purpose method. makes assumptions coordinate system, works distance matrix, handles parcellated vertex-level data. cost scales number smoothing parameters tried per permutation, typical parcellation sizes (50–400 regions) runs quickly. use : Default recommendation distance matrix want minimal assumptions spatial generating process.","code":"nulls_vario <- generate_nulls(   map_x,   method = \"burt2020\",   distmat = distmat,   n_perm = 100L,   seed = 1 ) nulls_vario #>  #> ── Null Distribution #> • Method: burt2020 #> • Permutations: 100 #> • Observations: 80"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"spatial-autoregressive-model-burt2018","dir":"Articles","previous_headings":"Distance-based methods","what":"Spatial autoregressive model (burt2018)","title":"Choosing and Using Null Models","text":"Burt et al. (2018) take generative approach: fit spatial autoregressive (SAR) model data, draw new samples model. SAR model captures spatial autocorrelation weight matrix derived distances estimated autocorrelation parameter. SAR model estimates two parameters: rho (spatial autocorrelation strength) d0 (distance decay scale). stored result: use : believe data follows autoregressive spatial process want surrogates drawn parametric model. assumption-heavy variogram matching, computationally cheaper per surrogate parameters estimated.","code":"nulls_sar <- generate_nulls(   map_x,   method = \"burt2018\",   distmat = distmat,   n_perm = 100L,   seed = 1 ) nulls_sar #>  #> ── Null Distribution #> • Method: burt2018 #> • Permutations: 100 #> • Observations: 80 nulls_sar$params$rho #>        wx  #> -23.71389 nulls_sar$params$d0 #> [1] 3.463286"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"moran-spectral-randomization-moran","dir":"Articles","previous_headings":"Distance-based methods","what":"Moran spectral randomization (moran)","title":"Choosing and Using Null Models","text":"Wagner Dray (2015) decompose data onto Moran’s eigenvector maps—spatial eigenvectors weighted connectivity matrix—randomly perturb coefficients. \"singleton\" procedure flips sign coefficient random; \"pair\" procedure applies random 2D rotations pairs coefficients similar eigenvalues. use : want preserve spectral properties spatial autocorrelation rather variogram. \"pair\" procedure conservative, preserving eigenvalue spectrum faithfully.","code":"nulls_moran <- generate_nulls(   map_x,   method = \"moran\",   distmat = distmat,   n_perm = 100L,   seed = 1,   procedure = \"singleton\" ) nulls_moran #>  #> ── Null Distribution #> • Method: moran #> • Permutations: 100 #> • Observations: 80"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"spin-based-methods","dir":"Articles","previous_headings":"","what":"Spin-based methods","title":"Choosing and Using Null Models","text":"Spin tests work fundamentally different principle. Instead generating synthetic data statistical model, take real data rotate cortical sphere. Values get reassigned original positions based proximity rotated positions. spin methods require coordinates organized list $lh $rh components—one matrix per hemisphere. hemisphere rotates independently.","code":"n_lh <- 40 n_rh <- 40 sphere_coords <- list(   lh = matrix(rnorm(n_lh * 3), ncol = 3),   rh = matrix(rnorm(n_rh * 3), ncol = 3) )  vertex_data <- rnorm(n_lh + n_rh)"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"original-spin-test-alexander_bloch","dir":"Articles","previous_headings":"Spin-based methods","what":"Original spin test (alexander_bloch)","title":"Choosing and Using Null Models","text":"method started (Alexander-Bloch et al., 2018). rotating coordinates, rotated vertex maps nearest original vertex. Multiple rotated vertices can map original, values get duplicated others dropped. simplest spin test fastest. tradeoff: many--one mapping distorts value distribution. preserving distribution matters, Hungarian variant appropriate.","code":"nulls_ab <- null_alexander_bloch(   vertex_data, sphere_coords,   n_perm = 100L, seed = 1 ) nulls_ab #>  #> ── Null Distribution #> • Method: alexander_bloch #> • Permutations: 100 #> • Observations: 80"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"greedy-assignment-spin_vasa","dir":"Articles","previous_headings":"Spin-based methods","what":"Greedy assignment (spin_vasa)","title":"Choosing and Using Null Models","text":"Vasa et al. (2018) proposed one--one greedy assignment: iterate vertices order, assigning nearest available (unassigned) rotated vertex. Every value appears exactly , assignment quality depends vertex ordering.","code":"nulls_vasa <- null_spin_vasa(   vertex_data, sphere_coords,   n_perm = 100L, seed = 1 ) nulls_vasa #>  #> ── Null Distribution #> • Method: spin_vasa #> • Permutations: 100 #> • Observations: 80"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"optimal-assignment-spin_hungarian","dir":"Articles","previous_headings":"Spin-based methods","what":"Optimal assignment (spin_hungarian)","title":"Choosing and Using Null Models","text":"Markello Misic (2021) showed optimal (Hungarian) assignment removes ordering bias greedy approach. minimizes total reassignment distance globally, producing best possible one--one mapping original rotated positions. Hungarian algorithm requires clue package runs cubic time number vertices. Slower greedy approach, strictly better assignments. use : recommended spin method vertex-level data want one--one assignment can afford extra computation.","code":"nulls_hung <- null_spin_hungarian(   vertex_data, sphere_coords,   n_perm = 100L, seed = 1 ) nulls_hung #>  #> ── Null Distribution #> • Method: spin_hungarian #> • Permutations: 100 #> • Observations: 80"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"parcel-spin-methods","dir":"Articles","previous_headings":"","what":"Parcel spin methods","title":"Choosing and Using Null Models","text":"data parcellated—one value per brain region rather per vertex—spin rotation still happens vertex level, reassignment happens parcel level. requires sphere coordinates (rotation) parcellation vector (know vertices belong parcel).","code":"n_parcel_lh <- 340 n_parcel_rh <- 340 parcel_coords <- list(   lh = matrix(rnorm(n_parcel_lh * 3), ncol = 3),   rh = matrix(rnorm(n_parcel_rh * 3), ncol = 3) ) parcellation <- rep(1:68, each = 10) parcel_data <- rnorm(68)"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"maximum-overlap-baum","dir":"Articles","previous_headings":"Parcel spin methods","what":"Maximum overlap (baum)","title":"Choosing and Using Null Models","text":"Baum et al. (2020) proposed rotating reassigning vertices nearest neighbours, original parcel takes value whichever rotated parcel vertex overlap . vertices parcel 3 now carry label parcel 7 rotation, parcel 3 gets parcel 7’s value.","code":"nulls_baum <- null_baum(   parcel_data, parcel_coords, parcellation,   n_perm = 50L, seed = 1 ) nulls_baum #>  #> ── Null Distribution #> • Method: baum #> • Permutations: 50 #> • Observations: 68"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"majority-vote-cornblath","dir":"Articles","previous_headings":"Parcel spin methods","what":"Majority vote (cornblath)","title":"Choosing and Using Null Models","text":"Cornblath et al. (2020) introduced refinement: rotated vertex first receives label nearest non-medial-wall original vertex. Parcels reassigned majority vote among resulting vertex labels. handles medial wall gracefully Baum’s method, since rotated vertices land medial wall get interpolated nearest valid region instead lost. use : Prefer Cornblath Baum parcellation includes medial wall vertices (labeled 0 NA), common case standard atlases.","code":"nulls_corn <- null_cornblath(   parcel_data, parcel_coords, parcellation,   n_perm = 50L, seed = 1 ) nulls_corn #>  #> ── Null Distribution #> • Method: cornblath #> • Permutations: 50 #> • Observations: 68"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"comparing-null-distributions-visually","dir":"Articles","previous_headings":"","what":"Comparing null distributions visually","title":"Choosing and Using Null Models","text":"practical way understand method : look surrogate values produces. compare first 50 surrogates two methods data: Surrogate distributions variogram-matching (left) Moran spectral randomization (right). dashed red line original data distribution. red dashed line shows original data distribution. Good surrogates similar overall distribution (value pool) different spatial arrangements.","code":"df <- data.frame(   value = c(     as.vector(nulls_vario$nulls[, 1:50]),     as.vector(nulls_moran$nulls[, 1:50])   ),   method = rep(     c(\"burt2020 (variogram)\", \"moran (spectral)\"),     each = n * 50   ) )  ggplot2::ggplot(df, ggplot2::aes(x = value)) +   ggplot2::geom_density(fill = \"steelblue\", alpha = 0.5) +   ggplot2::facet_wrap(~method) +   ggplot2::geom_density(     data = data.frame(value = map_x),     color = \"red\", linetype = \"dashed\", linewidth = 0.8   ) +   ggplot2::labs(x = \"Value\", y = \"Density\") +   ggplot2::theme_minimal()"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"using-permtest_metric-for-custom-metrics","dir":"Articles","previous_headings":"","what":"Using permtest_metric() for custom metrics","title":"Choosing and Using Null Models","text":"compare_maps() built around correlation. need different metric—mean absolute error, cosine similarity, whatever—use permtest_metric() function takes two vectors returns scalar: Pass null_method spatially-constrained surrogates instead random permutation:","code":"mae <- function(a, b) mean(abs(a - b))  result <- permtest_metric(   map_x, rnorm(n),   metric_func = mae,   n_perm = 200L,   seed = 1 ) result$observed #> [1] 1.271935 result$p_value #> [1] 0.06467662 result_spatial <- permtest_metric(   map_x, rnorm(n),   metric_func = mae,   n_perm = 200L,   seed = 1,   null_method = \"burt2020\",   distmat = distmat ) result_spatial$p_value #> [1] 0.9701493"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"building-custom-null-distributions","dir":"Articles","previous_headings":"","what":"Building custom null distributions","title":"Choosing and Using Null Models","text":"generate surrogates means—algorithm, external tool—can wrap null_distribution object use rest neuromapr: new_null_distribution() constructor produces object works compare_maps(nulls = ...), plot(), summary(), .matrix().","code":"custom_nulls <- matrix(rnorm(n * 50), nrow = n, ncol = 50) nd <- new_null_distribution(   custom_nulls,   method = \"custom\",   observed = map_x ) nd #>  #> ── Null Distribution #> • Method: custom #> • Permutations: 50 #> • Observations: 80 summary(nd) #> $method #> [1] \"custom\" #>  #> $n_perm #> [1] 50 #>  #> $n #> [1] 80 #>  #> $null_mean #>  [1]  0.172104151 -0.191992723  0.251970813 -0.089094615  0.005477459 #>  [6] -0.116195137  0.029984331 -0.140259990 -0.064275614  0.088438311 #> [11]  0.056367310 -0.020295656  0.107279055  0.061478744  0.028883291 #> [16] -0.124575306  0.116467203 -0.123478121  0.171316602 -0.320174552 #> [21] -0.101879306 -0.034256823  0.008095363 -0.166195389 -0.040686955 #> [26] -0.295944980 -0.158414959 -0.111692689  0.392321021 -0.118694798 #> [31]  0.271417483 -0.191272504 -0.075820891 -0.111577630 -0.050967630 #> [36] -0.079687220 -0.140829048  0.158767493  0.081045021 -0.155888319 #> [41]  0.007091098 -0.062884388 -0.015538874 -0.033575553  0.023571868 #> [46]  0.013706066 -0.098295867  0.070025536 -0.093369574 -0.158416906 #> [51] -0.101856761  0.174691830 -0.076514622  0.123438021 -0.088212642 #> [56] -0.027671164 -0.078829748 -0.000737019  0.192288238 -0.028717724 #> [61] -0.193521709 -0.096663995 -0.364682514 -0.118517540  0.173511672 #> [66]  0.038468503 -0.018096533  0.037188074 -0.072948543  0.110674743 #> [71] -0.012996721  0.385415691 -0.300242799 -0.180628593 -0.117331838 #> [76] -0.034619084 -0.046325206  0.115086854  0.063031223  0.011060466 #>  #> $null_sd #>  [1] 0.7654993 0.9942784 0.9519727 1.0154925 0.9496659 1.0151536 1.0555189 #>  [8] 1.0660867 0.7623388 1.0055644 1.0180568 1.1340219 1.0456170 0.9969020 #> [15] 1.0009006 0.9792541 0.8110526 0.9909006 1.0164368 0.9235815 0.7962349 #> [22] 1.1881215 1.0004296 0.9874878 1.0326598 1.0308064 1.0819856 0.9828809 #> [29] 1.0112092 1.0589840 0.8547717 0.9703791 0.9335735 1.0952835 0.9120905 #> [36] 0.9003178 1.0359273 0.8367114 0.9864675 0.8479680 0.9043361 0.8392895 #> [43] 0.9475172 0.9605337 1.0278489 1.1326076 1.0304862 0.9623529 1.0188185 #> [50] 0.9403089 0.9975970 1.0924189 0.9934468 1.0437525 0.8306250 0.9374071 #> [57] 0.8854729 0.9913599 0.9753211 1.1380680 1.0087496 1.0851607 0.9781671 #> [64] 0.9254884 0.9508746 1.0426264 1.1076917 0.9434507 1.0203667 1.0087854 #> [71] 1.0423534 1.1013250 0.8159138 1.0535077 0.8889507 1.0989718 0.9004764 #> [78] 1.0396253 0.9796304 0.8743524 #>  #> $observed #>  [1] -0.729217277  0.998068909  1.258481665  1.248863689 -1.380637050 #>  [6]  2.049960694  1.016872830 -0.026717464  0.703607779 -0.971385229 #> [11] -1.096156242  0.049050451 -1.198495857  0.190018999  1.297705900 #> [16] -1.033873723 -0.738440754  0.046563939 -1.017596120 -0.383283960 #> [21]  0.872755412  0.969545014  0.383846665 -1.851555663 -0.053996737 #> [26]  1.064773214  0.813195037 -0.190816474 -2.699929809  0.060966639 #> [31]  0.573751697  0.045803580  0.157412540  0.431565373 -0.396549736 #> [36]  1.309978226  0.470393400 -1.242670271  1.381575456  1.204458937 #> [41]  0.824073964 -1.662629402 -0.569306344  0.635513817  0.043722008 #> [46]  0.348012304  2.459593549 -0.818380324 -2.113200115  0.273695272 #> [51] -0.687596841  0.446041053 -0.812384724  2.212055480 -0.123705972 #> [56] -0.477335506 -0.166261491  0.862563384  0.097340485 -1.625616739 #> [61] -0.004620768  0.760242168  0.038990913  0.735072142 -0.146472627 #> [66] -0.057887335  0.482369466  0.992943637 -1.246395498 -0.033487525 #> [71] -0.070962181 -0.758920654 -1.034359361 -0.630731954  0.586807720 #> [76] -0.416322656 -0.784887810  0.163416319 -1.236714235  1.045873776"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"decision-guide","dir":"Articles","previous_headings":"","what":"Decision guide","title":"Choosing and Using Null Models","text":"faced choice, questions narrow : spherical coordinates? , use distance-based method (burt2020, burt2018, moran). data parcellated vertex-level? Parcellated + sphere coords points baum cornblath. Vertex-level + sphere coords points spin_hungarian alexander_bloch. medial wall matter? parcellation medial wall vertices, cornblath handles carefully baum. want parametric model? burt2018 fits explicit SAR model. moran preserves spectral properties. burt2020 distribution-free. Computational budget? alexander_bloch burt2018 fastest. spin_hungarian burt2020 slowest (often principled respective data types).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/null-models.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Choosing and Using Null Models","text":"Alexander-Bloch AF, Shou H, Liu S, et al. (2018). testing spatial correspondence maps human brain structure function. NeuroImage, 175, 111–120. Baum GL, Cui Z, Roalf DR, et al. (2020). Development structure–function coupling human brain networks youth. PNAS, 117, 21854–21861. Burt JB, Demirtas M, Eckner WJ, et al. (2018). Hierarchy transcriptomic specialization across human cortex captured structural connectivity. Nature Neuroscience, 21, 1251–1259. Burt JB, Helmer M, Shinn M, et al. (2020). Generative modeling brain maps spatial autocorrelation. NeuroImage, 220, 117038. Cornblath EJ, Ashourvan , Kim JZ, et al. (2020). Temporal sequences brain activity rest constrained white matter structure modulated cognitive demands. Communications Biology, 3, 590. Markello RD, Misic B (2021). Comparing spatial null models brain maps. NeuroImage, 236, 118052. Vasa F, Seidlitz J, Romero-Garcia R, et al. (2018). Adolescent tuning association cortex human structural brain networks. Cerebral Cortex, 28, 3293–3303. Wagner HH, Dray S (2015). Generating spatially constrained null models irregularly spaced data using Moran spectral randomization methods. Methods Ecology Evolution, 6, 1169–1178.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"vertices-to-parcels","dir":"Articles","previous_headings":"","what":"Vertices to parcels","title":"Working with Parcellated Data","text":"Suppose vertex-level brain map parcellation assigns vertex region. parcellation integer vector vertex gets label, 0 NA marking medial wall (vertices belong region). parcel gets mean constituent vertices. Medial wall vertices (label 0) excluded automatically. summary function configurable:","code":"set.seed(42) n_vertices <- 1000 vertex_data <- rnorm(n_vertices)  labels <- sample(   c(0, 1:10), n_vertices,   replace = TRUE, prob = c(0.1, rep(0.09, 10)) )  parcel_values <- vertices_to_parcels(vertex_data, labels) parcel_values #>            1            2            3            4            5            6  #> -0.001235255  0.142132938 -0.055766033 -0.162060178  0.027356454 -0.019617141  #>            7            8            9           10  #> -0.114211335 -0.047980452 -0.108683119  0.018359997 parcel_sd <- vertices_to_parcels(   vertex_data, labels, summary_func = sd ) parcel_sd #>         1         2         3         4         5         6         7         8  #> 1.0683513 1.0550975 0.9958556 1.0257398 1.0019210 0.8117328 0.9765293 1.0108265  #>         9        10  #> 1.0698179 0.9825964"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"parcels-back-to-vertices","dir":"Articles","previous_headings":"","what":"Parcels back to vertices","title":"Working with Parcellated Data","text":"reverse operation paints parcel-level values back onto vertex mesh. Every vertex gets parcel’s value; medial wall vertices get fill value. Vertices label 0 receive NA default. can change fill:","code":"vertex_filled <- parcels_to_vertices(parcel_values, labels) head(vertex_filled, 20) #>  [1] -0.001235255  0.027356454 -0.047980452  0.018359997  0.018359997 #>  [6] -0.108683119 -0.047980452  0.018359997  0.142132938 -0.162060178 #> [11] -0.114211335  0.142132938 -0.055766033 -0.047980452           NA #> [16] -0.108683119 -0.114211335 -0.047980452 -0.108683119 -0.001235255 vertex_filled_zero <- parcels_to_vertices(   parcel_values, labels, fill = 0 ) sum(vertex_filled_zero == 0) #> [1] 95"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"the-high-level-wrappers","dir":"Articles","previous_headings":"","what":"The high-level wrappers","title":"Working with Parcellated Data","text":"parcellate() unparcellate() add file-reading convenience top low-level functions. data lives disk GIFTI files, pass paths directly: function reads data file, reads parcellation labels, validates match length, calls vertices_to_parcels() underneath. working vectors already memory, wrappers still work—skip file-reading step: roundtrip lossless—parcellation lossy aggregation. unparcellate(parcellate(x)) gives parcel means broadcast back vertex positions, expected behaviour.","code":"parcel_vals <- parcellate(   \"cortical_thickness.func.gii\",   \"aparc.label.gii\" ) parcellated <- parcellate(vertex_data, labels) unparcellated <- unparcellate(parcellated, labels)  all.equal(   parcels_to_vertices(parcel_values, labels),   unparcellated ) #> [1] TRUE"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"parcel-centroids","dir":"Articles","previous_headings":"","what":"Parcel centroids","title":"Working with Parcellated Data","text":"analyses need know parcel lives 3D space—example, compute parcel-level distance matrix. get_parcel_centroids() offers three methods finding representative point parcel.","code":"vertices <- matrix(rnorm(n_vertices * 3), ncol = 3)"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"average-centroid","dir":"Articles","previous_headings":"Parcel centroids","what":"Average centroid","title":"Working with Parcellated Data","text":"Take mean x, y, z coordinates vertices parcel. Fast, resulting point may lie actual cortical surface.","code":"centroids_avg <- get_parcel_centroids(   vertices, labels, method = \"average\" ) head(centroids_avg) #>          [,1]         [,2]         [,3] #> 1  0.11396575  0.016773018 -0.065814398 #> 2  0.02388696 -0.035682772 -0.020913744 #> 3  0.07952778  0.101717196  0.091118296 #> 4 -0.08853466 -0.052836153 -0.058780127 #> 5  0.01771226  0.044216347  0.046963635 #> 6 -0.03578315 -0.004064188 -0.008321535"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"surface-centroid","dir":"Articles","previous_headings":"Parcel centroids","what":"Surface centroid","title":"Working with Parcellated Data","text":"Find vertex closest average centroid. result always actual vertex surface, matters centroids must respect cortical geometry.","code":"centroids_surf <- get_parcel_centroids(   vertices, labels, method = \"surface\" ) head(centroids_surf) #>          [,1]        [,2]       [,3] #> 1 -0.08089878  0.26659246  0.1365766 #> 2 -0.12375518 -0.01086631  0.1036001 #> 3  0.38467702 -0.10467462 -0.1120929 #> 4 -0.58301662  0.13731157 -0.1416120 #> 5 -0.40958087  0.15919765 -0.1902452 #> 6 -0.47109369 -0.34759792  0.1752621"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"geodesic-centroid","dir":"Articles","previous_headings":"Parcel centroids","what":"Geodesic centroid","title":"Working with Parcellated Data","text":"principled approach: find vertex minimizes sum geodesic (shortest-path--surface) distances vertices parcel. requires face matrix surface mesh igraph package. Geodesic centroids computationally expensive—compute pairwise shortest paths within parcel. large parcellations high-resolution meshes, surface centroid practical approximation.","code":"centroids_geo <- get_parcel_centroids(   vertices, labels,   method = \"geodesic\",   faces = faces )"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"building-a-parcel-level-distance-matrix","dir":"Articles","previous_headings":"","what":"Building a parcel-level distance matrix","title":"Working with Parcellated Data","text":"common use case: parcellated data need distance matrix null model generation. Parcel centroids get . distance matrix feeds directly generate_nulls():","code":"parcel_distmat <- as.matrix(dist(centroids_avg)) dim(parcel_distmat) #> [1] 10 10 parcel_map <- rnorm(nrow(centroids_avg)) nulls <- generate_nulls(   parcel_map,   method = \"moran\",   distmat = parcel_distmat,   n_perm = 100L,   seed = 1 ) nulls #>  #> ── Null Distribution #> • Method: moran #> • Permutations: 100 #> • Observations: 10"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"parcellation-and-null-models-together","dir":"Articles","previous_headings":"","what":"Parcellation and null models together","title":"Working with Parcellated Data","text":"parcel spin methods (baum cornblath) combine parcellation spin-based null generation. need spherical coordinates parcellation vector: rotation happens vertex resolution, output parcel-level: one surrogate value per parcel per permutation. right approach analysis variable measured parcel level want null model respect vertex-level spatial structure.","code":"n_lh <- 680 n_rh <- 680 sphere_coords <- list(   lh = matrix(rnorm(n_lh * 3), ncol = 3),   rh = matrix(rnorm(n_rh * 3), ncol = 3) ) parcellation <- rep(1:68, each = 20) parcel_data <- rnorm(68)  nulls_baum <- null_baum(   parcel_data, sphere_coords, parcellation,   n_perm = 50L, seed = 1 ) nulls_baum #>  #> ── Null Distribution #> • Method: baum #> • Permutations: 50 #> • Observations: 68"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"practical-considerations","dir":"Articles","previous_headings":"","what":"Practical considerations","title":"Working with Parcellated Data","text":"Parcellation size matters null models. 30–50 parcels, distance-based methods like burt2020 moran work well. hundreds parcels (e.g., Schaefer 400), spin-based methods become attractive leverage full vertex-level spatial structure. Medial wall handling. parcellation functions treat label 0 NA medial wall. cornblath null model handles medial wall vertices gracefully spin-based reassignment. parcellation substantial medial wall coverage, prefer cornblath baum. summary function determines testing. Using mean (default) tests whether average value region relates another variable. Using sd test whether within-region variability relates . Choose deliberately.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/parcellation.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Working with Parcellated Data","text":"Markello RD, Hansen JY, Liu Z-Q, et al. (2022). neuromaps: structural functional interpretation brain maps. Nature Methods, 19, 1472–1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"surface-meshes","dir":"Articles","previous_headings":"","what":"Surface meshes","title":"Surface Geometry","text":"cortical surface mesh consists two pieces: Vertices: n x 3 matrix 3D coordinates, one row per point surface. Faces: m x 3 matrix integer indices, row defining triangle referencing three vertices. Together describe geometry. build small mesh hand make examples concrete: Six vertices four triangles forming small irregular strip. Real cortical surfaces tens thousands vertices, operations .","code":"vertices <- matrix(c(   0, 0, 0,   1, 0, 0,   0.5, 1, 0,   1.5, 1, 0,   0, 2, 0,   1, 2, 0 ), ncol = 3, byrow = TRUE)  faces <- matrix(c(   1, 2, 3,   2, 3, 4,   3, 4, 6,   3, 5, 6 ), ncol = 3, byrow = TRUE)"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"building-a-surface-graph","dir":"Articles","previous_headings":"","what":"Building a surface graph","title":"Surface Geometry","text":"make_surf_graph() converts mesh weighted igraph object. edge connects two vertices share triangle, weight Euclidean distance . graph captures connectivity structure mesh—vertices adjacent far apart along surface. foundation geodesic distance computation. graph looks like, using vertex positions layout coordinates. Edge labels show Euclidean distance connected vertices: Surface graph toy mesh. Vertices positioned x-y coordinates, edges weighted Euclidean distance. real cortical surface, graph thousands nodes edges. structure : vertices connected triangle edges, weights encoding surface distances.","code":"g <- make_surf_graph(vertices, faces) g #> IGRAPH 4d61138 U-W- 6 9 --  #> + attr: weight (e/n) #> + edges from 4d61138: #> [1] 1--2 2--3 3--4 3--5 4--6 5--6 1--3 2--4 3--6 layout_xy <- vertices[, 1:2] edge_weights <- round(   igraph::E(g)$weight, 2 )  plot(   g,   layout = layout_xy,   vertex.size = 20,   vertex.color = \"steelblue\",   vertex.label.color = \"white\",   vertex.label.cex = 0.9,   edge.label = edge_weights,   edge.label.cex = 0.8,   edge.color = \"grey40\",   main = \"Surface mesh graph\" )"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"geodesic-distances","dir":"Articles","previous_headings":"","what":"Geodesic distances","title":"Surface Geometry","text":"Euclidean distance straight line 3D space. Geodesic distance follows surface, taking shortest path along mesh edges. convoluted surface like cortex, two can differ substantially. get_surface_distance() computes geodesic distances via Dijkstra’s algorithm surface graph: result symmetric n x n matrix shortest-path distances.","code":"dmat <- get_surface_distance(vertices, faces) dmat #>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6] #> [1,] 0.000000 1.000000 1.118034 2.118034 2.236068 2.236068 #> [2,] 1.000000 0.000000 1.118034 1.118034 2.236068 2.236068 #> [3,] 1.118034 1.118034 0.000000 1.000000 1.118034 1.118034 #> [4,] 2.118034 1.118034 1.000000 0.000000 2.118034 1.118034 #> [5,] 2.236068 2.236068 1.118034 2.118034 0.000000 1.000000 #> [6,] 2.236068 2.236068 1.118034 1.118034 1.000000 0.000000"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"partial-distance-matrices","dir":"Articles","previous_headings":"Geodesic distances","what":"Partial distance matrices","title":"Surface Geometry","text":"Computing full n x n matrix gets expensive large meshes. need distances subset source vertices, pass explicitly: 2 x 6 matrix: distances vertices 1 6 six vertices. parcellation centroid computations neighbourhood queries, selective approach saves considerable time.","code":"dmat_partial <- get_surface_distance(   vertices, faces, source_vertices = c(1, 6) ) dmat_partial #>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6] #> [1,] 0.000000 1.000000 1.118034 2.118034 2.236068 2.236068 #> [2,] 2.236068 2.236068 1.118034 1.118034 1.000000 0.000000"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"euclidean-vs-geodesic","dir":"Articles","previous_headings":"Geodesic distances","what":"Euclidean vs geodesic","title":"Surface Geometry","text":"flat mesh two distance measures coincide. folded cortex, geodesic distances always greater equal Euclidean, often substantially regions separated sulcus. flat toy mesh difference zero. real cortical surfaces, .","code":"euclid <- as.matrix(dist(vertices)) geodesic <- get_surface_distance(vertices, faces)  max(abs(geodesic - euclid)) #> [1] 0.3152584"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"vertex-areas","dir":"Articles","previous_headings":"","what":"Vertex areas","title":"Surface Geometry","text":"vertex surface mesh represents patch cortex. Knowing area matters area-weighted averaging understanding much cortical surface parcel covers. vertex_areas() distributes triangle’s area equally among three vertices: total vertex area equals total surface area triangles. Corner vertices (part fewer triangles) get less area interior vertices (shared triangles).","code":"areas <- vertex_areas(vertices, faces) areas #> [1] 0.1666667 0.3333333 0.6666667 0.3333333 0.1666667 0.3333333 sum(areas) #> [1] 2"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"checking-the-geometry","dir":"Articles","previous_headings":"Vertex areas","what":"Checking the geometry","title":"Surface Geometry","text":"sanity check: compute triangle areas directly verify sum total.","code":"tri_area <- function(v, f) {   a <- v[f[1], ]   b <- v[f[2], ]   cc <- v[f[3], ]   ab <- b - a   ac <- cc - a   cross <- c(     ab[2] * ac[3] - ab[3] * ac[2],     ab[3] * ac[1] - ab[1] * ac[3],     ab[1] * ac[2] - ab[2] * ac[1]   )   0.5 * sqrt(sum(cross^2)) }  total_tri <- sum(vapply(   seq_len(nrow(faces)),   function(i) tri_area(vertices, faces[i, ]),   numeric(1) ))  all.equal(sum(areas), total_tri) #> [1] TRUE"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"format-conversions","dir":"Articles","previous_headings":"","what":"Format conversions","title":"Surface Geometry","text":"Cortical surfaces come many file formats. FreeSurfer uses binary formats (.annot parcellations, .curv/.thickness/.sulc morphometry), modern tools increasingly expect GIFTI. neuromapr provides two conversion functions.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"annotation-to-gifti","dir":"Articles","previous_headings":"Format conversions","what":"Annotation to GIFTI","title":"Surface Geometry","text":"annot_to_gifti() converts FreeSurfer .annot file (parcellation labels) GIFTI label file:","code":"annot_to_gifti(\"lh.aparc.annot\", \"lh.aparc.label.gii\")"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"morphometry-to-gifti","dir":"Articles","previous_headings":"Format conversions","what":"Morphometry to GIFTI","title":"Surface Geometry","text":"fsmorph_to_gifti() converts FreeSurfer morphometry files GIFTI func files: functions require freesurferformats gifti packages. output path given, replace file extension automatically (.annot becomes .label.gii, .curv becomes .func.gii).","code":"fsmorph_to_gifti(\"lh.thickness\", \"lh.thickness.func.gii\")"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"resampling-between-coordinate-spaces","dir":"Articles","previous_headings":"","what":"Resampling between coordinate spaces","title":"Surface Geometry","text":"Brain maps different studies often live different coordinate spaces (fsaverage vs fsLR) different mesh densities (32k vs 164k). can compare , need space resolution. transform_to_space() handles resampling using Connectome Workbench via ciftiTools package: pairwise comparisons, resample_images() aligns two maps common space single call: Four strategies available: \"downsample_only\" — maps already share coordinate space; downsample higher-density one. \"transform_to_src\" — bring target source’s space. \"transform_to_trg\" — bring source target’s space. \"transform_to_alt\" — bring third space density. resampling functions require Connectome Workbench (wb_command). Use check_wb_command() verify installed locatable:","code":"transformed <- transform_to_space(   \"map.func.gii\",   target_space = \"fsLR\",   target_density = \"32k\" ) aligned <- resample_images(   src = \"map_a.func.gii\",   trg = \"map_b.func.gii\",   src_space = \"fsaverage\",   trg_space = \"fsLR\",   strategy = \"transform_to_trg\" ) check_wb_command()"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"putting-it-together","dir":"Articles","previous_headings":"","what":"Putting it together","title":"Surface Geometry","text":"typical workflow combines surface geometry rest neuromapr: Load surface mesh GIFTI .surf.gii file. Compute geodesic distances parcel centroids. Feed distance matrix spatially-constrained null model generation. analyses distinction Euclidean geodesic distance matters—highly folded cortex, parcels separated deep sulci—computing geodesic distances centroids can produce accurate null models.","code":"centroids <- get_parcel_centroids(   vertices, labels, method = \"surface\" ) distmat <- as.matrix(dist(centroids)) nulls <- generate_nulls(   parcel_data,   method = \"burt2020\",   distmat = distmat )"},{"path":"https://lcbc-uio.github.io/neuromapr/articles/surface-geometry.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Surface Geometry","text":"Markello RD, Hansen JY, Liu Z-Q, et al. (2022). neuromaps: structural functional interpretation brain maps. Nature Methods, 19, 1472–1480. doi:10.1038/s41592-022-01625-w Robinson EC, Jbabdi S, Glasser MF, et al. (2014). MSM: new flexible framework Multimodal Surface Matching. NeuroImage, 100, 414–426. doi:10.1016/j.neuroimage.2014.07.033","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Athanasia Mo Mowinckel. Author, maintainer.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mowinckel (2026). neuromapr: Spatial Null Models Transforms Brain Map Comparison. R package version 0.2.0, https://github.com/lcbc-uio/neuromapr.","code":"@Manual{,   title = {neuromapr: Spatial Null Models and Transforms for Brain Map Comparison},   author = {Athanasia Mo Mowinckel},   year = {2026},   note = {R package version 0.2.0},   url = {https://github.com/lcbc-uio/neuromapr}, }"},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"neuromapr-","dir":"","previous_headings":"","what":"Spatial Null Models and Transforms for Brain Map Comparison","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"Brain maps spatially autocorrelated — nearby regions similar values just neighbours. Standard correlation tests ignore produce inflated p-values. neuromapr generates spatially-constrained surrogate maps preserve autocorrelation structure, can test whether similarity two brain maps spatial artifact. package implements framework described Markello et al. (2022) provides eight null model methods, parcellation utilities, geodesic surface distance, coordinate-space transforms. package co-developed Claude Code (Anthropic’s Claude Opus 4.6). test suite thorough defaults aligned neuromaps Python reference implementation, discrepancies may still exist early stage. encourage users cross-validate results neuromaps report issues.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"Install lcbc-uio r-universe: install development version GitHub:","code":"options(repos = c(   lcbcuio = \"https://lcbc-uio.r-universe.dev\",   CRAN = \"https://cloud.r-project.org\" ))  install.packages(\"neuromapr\") # install.packages(\"pak\") pak::pak(\"lcbc-uio/neuromapr\")"},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"Compare two brain maps spatial null model three lines: p_null accounts spatial autocorrelation. parametric p .","code":"library(neuromapr) set.seed(42) n <- 100 distmat <- as.matrix(dist(matrix(rnorm(n * 3), ncol = 3)))  map_a <- rnorm(n) map_b <- 0.4 * map_a + rnorm(n, sd = 0.8)  compare_maps(   map_a,   map_b,   null_method = \"burt2020\",   distmat = distmat,   n_perm = 500L,   seed = 1,   verbose = FALSE ) #>  #> ── Brain Map Comparison #> Method: pearson #> r = 0.5302, p = 1.4e-08 #> n = 100 #> ──────────────────────────────────────────────────────────────────────────────── #> Null model: burt2020 (500 permutations) #> p_null = 0.002"},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"null-model-methods","dir":"","previous_headings":"","what":"Null model methods","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"neuromapr provides eight methods across three families: methods accessed generate_nulls() directly via dedicated functions (e.g., null_burt2020(), null_moran()).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"Parcellation utilities — aggregate vertex data parcels, map parcel values back vertices, compute parcel centroids using average, surface, geodesic methods. Geodesic surface distance — shortest-path distances along triangular mesh, analyses Euclidean distance brain reflect cortical proximity. Custom metric testing — permtest_metric() runs permutation test metric function, optionally using spatial null surrogates: Format conversions — convert FreeSurfer .annot morphometry files GIFTI annot_to_gifti() fsmorph_to_gifti().","code":"vertex_data <- rnorm(1000) labels <- rep(1:10, each = 100)  parcel_means <- vertices_to_parcels(vertex_data, labels) head(parcel_means) #>           1           2           3           4           5           6  #>  0.11795689 -0.03426519 -0.05073563  0.04712785  0.06088535 -0.04200267 vertices <- matrix(   c(0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0),   ncol = 3,   byrow = TRUE ) faces <- matrix(c(1, 2, 3, 2, 3, 4), ncol = 3, byrow = TRUE)  get_surface_distance(vertices, faces) #>      [,1]     [,2]     [,3] [,4] #> [1,]    0 1.000000 1.000000    2 #> [2,]    1 0.000000 1.414214    1 #> [3,]    1 1.414214 0.000000    1 #> [4,]    2 1.000000 1.000000    0 result <- permtest_metric(   map_a,   map_b,   metric_func = function(x, y) mean(abs(x - y)),   n_perm = 200L,   seed = 1 ) result$p_value #> [1] 1"},{"path":"https://lcbc-uio.github.io/neuromapr/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Spatial Null Models and Transforms for Brain Map Comparison","text":"use neuromapr, please cite neuromaps framework: Markello RD, Hansen JY, Liu Z-Q, et al. (2022). neuromaps: structural functional interpretation brain maps. Nature Methods, 19, 1472–1480. doi:10.1038/s41592-022-01625-w Individual null model methods citations documented function’s help page.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/annot_to_gifti.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","title":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","text":"Reads FreeSurfer .annot file writes GIFTI label file.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/annot_to_gifti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","text":"","code":"annot_to_gifti(annot_path, output_path = NULL)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/annot_to_gifti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","text":"annot_path Path FreeSurfer .annot file. output_path Output GIFTI path. NULL, replaces extension .label.gii.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/annot_to_gifti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","text":"output file path (invisibly).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/annot_to_gifti.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Convert FreeSurfer annotation to GIFTI — annot_to_gifti","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/check_wb_command.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for Connectome Workbench — check_wb_command","title":"Check for Connectome Workbench — check_wb_command","text":"Verifies wb_command available. wb_path NULL, checks ciftiTools default system PATH.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/check_wb_command.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for Connectome Workbench — check_wb_command","text":"","code":"check_wb_command(wb_path = NULL)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/check_wb_command.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for Connectome Workbench — check_wb_command","text":"wb_path Optional explicit path wb_command.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/check_wb_command.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for Connectome Workbench — check_wb_command","text":"Path wb_command executable.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/compare_maps.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare brain maps with spatial null model significance testing — compare_maps","title":"Compare brain maps with spatial null model significance testing — compare_maps","text":"Computes correlation two brain maps optionally tests significance using spatial null model account spatial autocorrelation.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/compare_maps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare brain maps with spatial null model significance testing — compare_maps","text":"","code":"compare_maps(   x,   y,   method = c(\"pearson\", \"spearman\"),   null_method = NULL,   n_perm = 1000L,   nulls = NULL,   distmat = NULL,   coords = NULL,   seed = NULL,   na.rm = TRUE,   verbose = TRUE,   ... )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/compare_maps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare brain maps with spatial null model significance testing — compare_maps","text":"x, y Numeric vectors brain map values, file paths GIFTI/NIfTI files. method Correlation method: \"pearson\" \"spearman\". null_method Optional null model method empirical p-values. One \"burt2020\", \"moran\", \"spin_vasa\", \"spin_hungarian\", \"alexander_bloch\", \"baum\", \"cornblath\", \"burt2018\", NULL parametric . n_perm Integer number null permutations. nulls Pre-computed null_distribution object x. distmat Distance matrix (passed null model needed). coords Coordinate list (passed spin null models needed). seed Optional integer seed reproducibility. na.rm Logical, remove NA values computing correlation. verbose Logical, print progress messages. ... Additional arguments passed generate_nulls().","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/compare_maps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare brain maps with spatial null model significance testing — compare_maps","text":"neuromaps_enhanced_comparison object (inherits neuromaps_comparison) additional fields p_null, null_method, null_r, n_perm.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/compare_maps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compare brain maps with spatial null model significance testing — compare_maps","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fetch_neuromaps_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Download a neuromaps annotation — fetch_neuromaps_annotation","title":"Download a neuromaps annotation — fetch_neuromaps_annotation","text":"Download brain map annotation files neuromaps OSF repository. Surface annotations return two files (left right hemispheres), volume annotations return one.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fetch_neuromaps_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download a neuromaps annotation — fetch_neuromaps_annotation","text":"","code":"fetch_neuromaps_annotation(   source,   desc,   space,   density = NULL,   resolution = NULL,   hemisphere = NULL,   data_dir = neuromaps_cache_dir(),   overwrite = FALSE,   verbose = TRUE )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fetch_neuromaps_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download a neuromaps annotation — fetch_neuromaps_annotation","text":"source Data source identifier (e.g. \"abagen\", \"beliveau\"). desc Map descriptor key (e.g. \"genepc1\", \"feobv\"). space Coordinate space (e.g. \"fsaverage\", \"MNI152\", \"fsLR\"). density Surface vertex density (e.g. \"10k\", \"164k\"). Mutually exclusive resolution. resolution Volume voxel resolution (e.g. \"1mm\", \"2mm\"). Mutually exclusive density. hemisphere Hemisphere (\"L\" \"R\"). data_dir Directory cached downloads. Defaults neuromaps_cache_dir(). overwrite Re-download even cached file exists. verbose Print progress messages.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fetch_neuromaps_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download a neuromaps annotation — fetch_neuromaps_annotation","text":"Character vector downloaded file path(s).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fetch_neuromaps_annotation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download a neuromaps annotation — fetch_neuromaps_annotation","text":"","code":"if (FALSE) { # \\dontrun{ fetch_neuromaps_annotation(\"abagen\", \"genepc1\", \"fsaverage\", density = \"10k\") } # }"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fsmorph_to_gifti.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","title":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","text":"Reads FreeSurfer morphometry file (.curv, .thickness, .sulc) writes GIFTI func file.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fsmorph_to_gifti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","text":"","code":"fsmorph_to_gifti(morph_path, output_path = NULL)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fsmorph_to_gifti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","text":"morph_path Path FreeSurfer morphometry file. output_path Output GIFTI path. NULL, replaces extension .func.gii.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fsmorph_to_gifti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","text":"output file path (invisibly).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/fsmorph_to_gifti.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Convert FreeSurfer morphometry to GIFTI — fsmorph_to_gifti","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/generate_nulls.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate null distributions for brain map data — generate_nulls","title":"Generate null distributions for brain map data — generate_nulls","text":"Dispatches appropriate null model method generating spatially-constrained surrogate brain maps.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/generate_nulls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate null distributions for brain map data — generate_nulls","text":"","code":"generate_nulls(   data,   method = c(\"burt2020\", \"moran\", \"spin_vasa\", \"spin_hungarian\", \"alexander_bloch\",     \"baum\", \"cornblath\", \"burt2018\"),   n_perm = 1000L,   distmat = NULL,   coords = NULL,   parcellation = NULL,   seed = NULL,   ... )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/generate_nulls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate null distributions for brain map data — generate_nulls","text":"data Numeric vector brain map values. method Character string specifying null model method. n_perm Integer number null permutations generate. distmat Distance matrix (required \"burt2020\", \"burt2018\", \"moran\"). coords List $lh $rh coordinate matrices (required spin methods). parcellation Integer vector parcel labels (required \"baum\" \"cornblath\"). seed Optional integer seed reproducibility. ... Additional arguments passed specific null method (e.g. rotation spin methods, kernel moran/burt2020).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/generate_nulls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate null distributions for brain map data — generate_nulls","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/generate_nulls.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate null distributions for brain map data — generate_nulls","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_parcel_centroids.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute parcel centroids — get_parcel_centroids","title":"Compute parcel centroids — get_parcel_centroids","text":"Finds centroid parcel using one three methods.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_parcel_centroids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute parcel centroids — get_parcel_centroids","text":"","code":"get_parcel_centroids(   vertices,   labels,   method = c(\"average\", \"surface\", \"geodesic\"),   faces = NULL )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_parcel_centroids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute parcel centroids — get_parcel_centroids","text":"vertices Numeric matrix (n x 3) vertex coordinates. labels Integer vector parcel labels. 0 NA medial wall. method Centroid method: \"average\" (coordinate means), \"surface\" (vertex closest average centroid), \"geodesic\" (vertex minimizing sum geodesic distances within parcel). faces Integer matrix (m x 3) face indices. Required \"geodesic\" method.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_parcel_centroids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute parcel centroids — get_parcel_centroids","text":"Numeric matrix (n_parcels x 3) rownames set parcel labels.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_parcel_centroids.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute parcel centroids — get_parcel_centroids","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_surface_distance.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute geodesic distances on a surface mesh — get_surface_distance","title":"Compute geodesic distances on a surface mesh — get_surface_distance","text":"Builds graph triangular mesh computes shortest-path (Dijkstra) distances vertices.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_surface_distance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute geodesic distances on a surface mesh — get_surface_distance","text":"","code":"get_surface_distance(vertices, faces, source_vertices = NULL)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_surface_distance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute geodesic distances on a surface mesh — get_surface_distance","text":"vertices Numeric matrix (n x 3) vertex coordinates. faces Integer matrix (m x 3) face indices (1-indexed). source_vertices Optional integer vector source vertex indices. NULL, computes full n x n distance matrix.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_surface_distance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute geodesic distances on a surface mesh — get_surface_distance","text":"Numeric distance matrix. source_vertices provided, returns length(source_vertices) x n matrix; otherwise n x n matrix.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/get_surface_distance.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute geodesic distances on a surface mesh — get_surface_distance","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/make_surf_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Build an igraph from a triangular surface mesh — make_surf_graph","title":"Build an igraph from a triangular surface mesh — make_surf_graph","text":"Extracts unique edges triangular faces, computes Euclidean edge weights, returns igraph graph object suitable geodesic distance computation.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/make_surf_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build an igraph from a triangular surface mesh — make_surf_graph","text":"","code":"make_surf_graph(vertices, faces)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/make_surf_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build an igraph from a triangular surface mesh — make_surf_graph","text":"vertices Numeric matrix (n x 3) vertex coordinates. faces Integer matrix (m x 3) face indices (1-indexed).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/make_surf_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build an igraph from a triangular surface mesh — make_surf_graph","text":"igraph graph object weighted edges.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/make_surf_graph.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Build an igraph from a triangular surface mesh — make_surf_graph","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromapr-package.html","id":null,"dir":"Reference","previous_headings":"","what":" — neuromapr-package","title":" — neuromapr-package","text":"Implements spatial null models coordinate-space transformations statistical comparison brain maps, following framework described Markello et al. (2022) doi:10.1038/s41592-022-01625-w . Provides variogram-matching surrogates (Burt et al. 2020), Moran spectral randomization (Wagner & Dray 2015), spin-based permutation tests (Alexander-Bloch et al. 2018). Includes R interface 'neuromaps' annotation registry browsing, downloading, comparing brain map annotations OSF. Integrates 'ciftiTools' coordinate-space transforms.","code":""},{"path":[]},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromapr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":" — neuromapr-package","text":"Maintainer: Athanasia Mo Mowinckel .m.mowinckel@psykologi.uio.(ORCID)","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":null,"dir":"Reference","previous_headings":"","what":"List available neuromaps annotations — neuromaps_available","title":"List available neuromaps annotations — neuromaps_available","text":"Query neuromaps registry see brain map annotations available download. Data fetched neuromaps project's GitHub repository cached session.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available neuromaps annotations — neuromaps_available","text":"","code":"neuromaps_available(   source = NULL,   desc = NULL,   space = NULL,   density = NULL,   resolution = NULL,   hemisphere = NULL,   tags = NULL,   format = NULL )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List available neuromaps annotations — neuromaps_available","text":"source Data source identifier (e.g. \"abagen\", \"beliveau\"). desc Map descriptor key (e.g. \"genepc1\", \"feobv\"). space Coordinate space (e.g. \"fsaverage\", \"MNI152\", \"fsLR\"). density Surface vertex density (e.g. \"10k\", \"164k\"). Mutually exclusive resolution. resolution Volume voxel resolution (e.g. \"1mm\", \"2mm\"). Mutually exclusive density. hemisphere Hemisphere (\"L\" \"R\"). tags Character vector tags. must match (logic). format Filter format (\"surface\" \"volume\").","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available neuromaps annotations — neuromaps_available","text":"tibble available annotations columns: source, desc, space, den, res, hemi, format, fname, full_desc, tags, N, age.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"List available neuromaps annotations — neuromaps_available","text":"used neuromaps_available(), parameters act regex filters. used fetch_neuromaps_annotation(), source, desc, space exact matches.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/neuromaps_available.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List available neuromaps annotations — neuromaps_available","text":"","code":"if (FALSE) { # \\dontrun{ neuromaps_available() neuromaps_available(source = \"beliveau\") neuromaps_available(tags = \"pet\") } # }"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_alexander_bloch.html","id":null,"dir":"Reference","previous_headings":"","what":"Alexander-Bloch spin test null model — null_alexander_bloch","title":"Alexander-Bloch spin test null model — null_alexander_bloch","text":"Original vertex-level spin test: rotates coordinates assigns rotated vertex value nearest original vertex (optimal matching).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_alexander_bloch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Alexander-Bloch spin test null model — null_alexander_bloch","text":"","code":"null_alexander_bloch(   data,   coords,   n_perm = 1000L,   seed = NULL,   rotation = c(\"euler\", \"rodrigues\") )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_alexander_bloch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Alexander-Bloch spin test null model — null_alexander_bloch","text":"data Numeric vector brain map values. coords List $lh $rh matrices spherical coordinates (n x 3 ). n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. rotation Rotation generation method: \"euler\" (ZYZ Euler angles, default, matches neuromaps Python) \"rodrigues\" (Rodrigues axis-angle formula).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_alexander_bloch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Alexander-Bloch spin test null model — null_alexander_bloch","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_alexander_bloch.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Alexander-Bloch spin test null model — null_alexander_bloch","text":"Alexander-Bloch AF et al. (2018) NeuroImage 175:111-120. doi:10.1016/j.neuroimage.2018.04.023","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_baum.html","id":null,"dir":"Reference","previous_headings":"","what":"Baum spin test null model — null_baum","title":"Baum spin test null model — null_baum","text":"Spin-based null model maximum-overlap parcel reassignment. rotating vertex coordinates, original parcel assigned value rotated parcel vertex overlap.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_baum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Baum spin test null model — null_baum","text":"","code":"null_baum(   data,   coords,   parcellation,   n_perm = 1000L,   seed = NULL,   rotation = c(\"euler\", \"rodrigues\") )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_baum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Baum spin test null model — null_baum","text":"data Numeric vector brain map values. coords List $lh $rh matrices spherical coordinates (n x 3 ). parcellation Integer vector parcel labels vertices. 0 NA indicate medial wall. n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. rotation Rotation generation method: \"euler\" (ZYZ Euler angles, default, matches neuromaps Python) \"rodrigues\" (Rodrigues axis-angle formula).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_baum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Baum spin test null model — null_baum","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_baum.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Baum spin test null model — null_baum","text":"Baum GL et al. (2020) PNAS 117:21854-21861. doi:10.1073/pnas.2005518117","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2018.html","id":null,"dir":"Reference","previous_headings":"","what":"Burt 2018 spatial autoregressive null model — null_burt2018","title":"Burt 2018 spatial autoregressive null model — null_burt2018","text":"Generates surrogate brain maps using spatial autoregressive (SAR) model. Estimates spatial autocorrelation distance decay parameters, generates surrogates solving SAR equation rank-matching original data.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2018.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Burt 2018 spatial autoregressive null model — null_burt2018","text":"","code":"null_burt2018(data, distmat, n_perm = 1000L, seed = NULL)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2018.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Burt 2018 spatial autoregressive null model — null_burt2018","text":"data Numeric vector brain map values. distmat Distance matrix parcels/vertices. n_perm Integer number null permutations generate. seed Optional integer seed reproducibility.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2018.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Burt 2018 spatial autoregressive null model — null_burt2018","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2018.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Burt 2018 spatial autoregressive null model — null_burt2018","text":"Burt JB et al. (2018) Nature Neuroscience 21:1251-1259. doi:10.1038/s41593-018-0195-0","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2020.html","id":null,"dir":"Reference","previous_headings":"","what":"Variogram-matching null model — null_burt2020","title":"Variogram-matching null model — null_burt2020","text":"Generates spatially-constrained surrogate brain maps matching empirical variogram original data smoothed random permutations.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2020.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variogram-matching null model — null_burt2020","text":"","code":"null_burt2020(   data,   distmat,   n_perm = 1000L,   seed = NULL,   ns = 500L,   nh = 25L,   pv = 25,   knn = 1000L,   deltas = seq(0.1, 0.9, by = 0.1),   kernel = c(\"exponential\", \"gaussian\", \"uniform\"),   resample = FALSE )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2020.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variogram-matching null model — null_burt2020","text":"data Numeric vector brain map values. distmat Distance matrix parcels/vertices. n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. ns Integer, subsample size variogram computation. nh Integer, number distance bins variogram. pv Numeric, percentile cutoff maximum distance variogram. knn Integer, number nearest neighbors smoothing. deltas Numeric vector smoothing levels (fractions knn). kernel Smoothing kernel function. resample Logical. FALSE (default, matches brainsmash Python), variogram subsample indices computed reused across permutations. TRUE, fresh subsample drawn time.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2020.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variogram-matching null model — null_burt2020","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_burt2020.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Variogram-matching null model — null_burt2020","text":"Burt JB et al. (2020) NeuroImage 220:117038. doi:10.1016/j.neuroimage.2020.117038","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_cornblath.html","id":null,"dir":"Reference","previous_headings":"","what":"Cornblath spin test null model — null_cornblath","title":"Cornblath spin test null model — null_cornblath","text":"Spin-based null model rotated vertex receives label nearest non-medial-wall original vertex, parcels reassigned majority vote among resulting vertex labels.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_cornblath.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cornblath spin test null model — null_cornblath","text":"","code":"null_cornblath(   data,   coords,   parcellation,   n_perm = 1000L,   seed = NULL,   rotation = c(\"euler\", \"rodrigues\") )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_cornblath.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cornblath spin test null model — null_cornblath","text":"data Numeric vector brain map values. coords List $lh $rh matrices spherical coordinates (n x 3 ). parcellation Integer vector parcel labels vertices. 0 NA indicate medial wall. n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. rotation Rotation generation method: \"euler\" (ZYZ Euler angles, default, matches neuromaps Python) \"rodrigues\" (Rodrigues axis-angle formula).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_cornblath.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cornblath spin test null model — null_cornblath","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_cornblath.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cornblath spin test null model — null_cornblath","text":"Cornblath EJ et al. (2020) Communications Biology 3:590. doi:10.1038/s42003-020-01296-5","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a null distribution object — null_distribution","title":"Create a null distribution object — null_distribution","text":"Create null distribution object","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a null distribution object — null_distribution","text":"","code":"new_null_distribution(nulls, method, observed, params = list())"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a null distribution object — null_distribution","text":"nulls Numeric matrix (n x n_perm) surrogate values. method Character string identifying null model method. observed Numeric vector original data values. params Named list algorithm parameters.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a null distribution object — null_distribution","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_moran.html","id":null,"dir":"Reference","previous_headings":"","what":"Moran spectral randomization null model — null_moran","title":"Moran spectral randomization null model — null_moran","text":"Generates spatially-constrained surrogate brain maps using Moran's eigenvector maps (MEMs) spectral randomization.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_moran.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Moran spectral randomization null model — null_moran","text":"","code":"null_moran(   data,   distmat,   n_perm = 1000L,   seed = NULL,   procedure = c(\"pair\", \"singleton\"),   kernel = c(\"inverse_distance\", \"exponential\", \"gaussian\", \"bisquare\"),   tol = 1e-06 )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_moran.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Moran spectral randomization null model — null_moran","text":"data Numeric vector brain map values. distmat Distance matrix parcels/vertices. n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. procedure Character, either \"pair\" (default, random 2D rotations near-degenerate eigenvector pairs, matches neuromaps Python) \"singleton\" (random sign flips individual eigenvectors). kernel Weight matrix kernel: \"inverse_distance\" (default, matches neuromaps Python), \"exponential\", \"gaussian\", \"bisquare\". tol Numeric tolerance eigenvalue comparison.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_moran.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Moran spectral randomization null model — null_moran","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_moran.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Moran spectral randomization null model — null_moran","text":"Wagner HH, Dray S (2015) Methods Ecology Evolution 6:1169-1178. doi:10.1111/2041-210X.12407","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_spin_vasa.html","id":null,"dir":"Reference","previous_headings":"","what":"Spin-test null models for brain maps — null_spin_vasa","title":"Spin-test null models for brain maps — null_spin_vasa","text":"Generate spatially-constrained null distributions using spin-based permutation spherical coordinates.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_spin_vasa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spin-test null models for brain maps — null_spin_vasa","text":"","code":"null_spin_vasa(   data,   coords,   n_perm = 1000L,   seed = NULL,   rotation = c(\"euler\", \"rodrigues\") )  null_spin_hungarian(   data,   coords,   n_perm = 1000L,   seed = NULL,   rotation = c(\"euler\", \"rodrigues\") )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_spin_vasa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spin-test null models for brain maps — null_spin_vasa","text":"data Numeric vector brain map values. coords List $lh $rh matrices spherical coordinates (n x 3 ). n_perm Integer number null permutations generate. seed Optional integer seed reproducibility. rotation Rotation generation method: \"euler\" (ZYZ Euler angles, default, matches neuromaps Python) \"rodrigues\" (Rodrigues axis-angle formula).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_spin_vasa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spin-test null models for brain maps — null_spin_vasa","text":"null_distribution object.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/null_spin_vasa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Spin-test null models for brain maps — null_spin_vasa","text":"Alexander-Bloch AF et al. (2018) NeuroImage 175:111-120. doi:10.1016/j.neuroimage.2018.04.023 Vasa F et al. (2018) Cerebral Cortex 28:3293-3303. doi:10.1093/cercor/bhx195 Markello RD, Misic B (2021) NeuroImage 236:118052. doi:10.1016/j.neuroimage.2021.118052","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcellate.html","id":null,"dir":"Reference","previous_headings":"","what":"Parcellate brain map data — parcellate","title":"Parcellate brain map data — parcellate","text":"High-level wrapper reads data parcellation file paths vectors, aggregates vertices parcels.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcellate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parcellate brain map data — parcellate","text":"","code":"parcellate(data, parcellation, summary_func = mean)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcellate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parcellate brain map data — parcellate","text":"data Numeric vector file path GIFTI/NIfTI brain map. parcellation Integer vector labels file path GIFTI label file. summary_func Function summarise parcel (default: mean).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcellate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parcellate brain map data — parcellate","text":"Named numeric vector parcel-level values.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcellate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Parcellate brain map data — parcellate","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcels_to_vertices.html","id":null,"dir":"Reference","previous_headings":"","what":"Map parcel data back to vertices — parcels_to_vertices","title":"Map parcel data back to vertices — parcels_to_vertices","text":"Expands parcel-level values vertex-level vector using parcellation labels.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcels_to_vertices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map parcel data back to vertices — parcels_to_vertices","text":"","code":"parcels_to_vertices(parcel_data, labels, fill = NA_real_)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcels_to_vertices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map parcel data back to vertices — parcels_to_vertices","text":"parcel_data Named numeric vector parcel values (names match labels). labels Integer vector parcel labels. 0 NA medial wall. fill Value medial wall vertices (default: NA_real_).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcels_to_vertices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map parcel data back to vertices — parcels_to_vertices","text":"Numeric vector length(labels).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/parcels_to_vertices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Map parcel data back to vertices — parcels_to_vertices","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/permtest_metric.html","id":null,"dir":"Reference","previous_headings":"","what":"Permutation test for any metric between brain maps — permtest_metric","title":"Permutation test for any metric between brain maps — permtest_metric","text":"Computes user-specified metric two vectors tests significance using either spatially-constrained null surrogates simple random permutation.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/permtest_metric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Permutation test for any metric between brain maps — permtest_metric","text":"","code":"permtest_metric(   x,   y,   metric_func = stats::cor,   n_perm = 1000L,   seed = NULL,   null_method = NULL,   distmat = NULL,   coords = NULL,   parcellation = NULL,   ... )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/permtest_metric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Permutation test for any metric between brain maps — permtest_metric","text":"x, y Numeric vectors. metric_func Function taking (x, y) returning scalar. n_perm Integer number permutations. seed Optional integer seed reproducibility. null_method Optional null model method passed generate_nulls(). NULL, uses simple random permutation. distmat Distance matrix (passed generate_nulls() needed). coords Coordinate list (passed generate_nulls() needed). parcellation Integer vector (passed generate_nulls() needed). ... Additional arguments passed generate_nulls().","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/permtest_metric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Permutation test for any metric between brain maps — permtest_metric","text":"List $observed, $null_values, $p_value, $n_perm.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/permtest_metric.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Permutation test for any metric between brain maps — permtest_metric","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/read_brain_map_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Read vertex/voxel values from a brain map file — read_brain_map_values","title":"Read vertex/voxel values from a brain map file — read_brain_map_values","text":"Reads GIFTI (.func.gii) NIfTI (.nii.gz) files returns values numeric vector. Used internally compare_maps() file paths passed instead numeric vectors.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/read_brain_map_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read vertex/voxel values from a brain map file — read_brain_map_values","text":"","code":"read_brain_map_values(path)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/read_brain_map_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read vertex/voxel values from a brain map file — read_brain_map_values","text":"path Path .func.gii (GIFTI) .nii.gz (NIfTI) file.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/read_brain_map_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read vertex/voxel values from a brain map file — read_brain_map_values","text":"numeric vector map values.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/resample_images.html","id":null,"dir":"Reference","previous_headings":"","what":"Resample brain maps for comparison — resample_images","title":"Resample brain maps for comparison — resample_images","text":"Aligns two brain maps coordinate space density comparison. Supports multiple strategies choosing target space.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/resample_images.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resample brain maps for comparison — resample_images","text":"","code":"resample_images(   src,   trg,   src_space = c(\"fsaverage\", \"fsLR\"),   trg_space = c(\"fsaverage\", \"fsLR\"),   strategy = c(\"downsample_only\", \"transform_to_src\", \"transform_to_trg\",     \"transform_to_alt\"),   alt_space = NULL,   alt_density = NULL,   hemisphere = c(\"left\", \"right\"),   area_surf_current = NULL,   area_surf_new = NULL,   wb_path = NULL,   verbose = TRUE )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/resample_images.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resample brain maps for comparison — resample_images","text":"src Character, file path source GIFTI. trg Character, file path target GIFTI. src_space Source coordinate space (\"fsaverage\" \"fsLR\"). trg_space Target coordinate space (\"fsaverage\" \"fsLR\"). strategy Resampling strategy. One \"downsample_only\", \"transform_to_src\", \"transform_to_trg\", \"transform_to_alt\". alt_space Alternative space \"transform_to_alt\" strategy. alt_density Alternative density \"transform_to_alt\" strategy. hemisphere hemispheres: \"left\", \"right\", . area_surf_current Path current-resolution area-correction surface (e.g. midthickness). Passed transform_to_space(). area_surf_new Path target-resolution area-correction surface. Passed transform_to_space(). wb_path Path wb_command executable. verbose Logical, print progress messages.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/resample_images.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resample brain maps for comparison — resample_images","text":"List $src $trg file paths aligned space.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/resample_images.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Resample brain maps for comparison — resample_images","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/transform_to_space.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform brain maps between coordinate spaces — transform_to_space","title":"Transform brain maps between coordinate spaces — transform_to_space","text":"Resamples GIFTI surface files fsaverage fsLR coordinate spaces using Connectome Workbench via ciftiTools.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/transform_to_space.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform brain maps between coordinate spaces — transform_to_space","text":"","code":"transform_to_space(   paths,   target_space = c(\"fsLR\", \"fsaverage\"),   target_density = \"32k\",   hemisphere = c(\"left\", \"right\"),   method = c(\"adaptive\", \"barycentric\"),   area_surf_current = NULL,   area_surf_new = NULL,   wb_path = NULL,   verbose = TRUE )"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/transform_to_space.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform brain maps between coordinate spaces — transform_to_space","text":"paths Character vector GIFTI file paths transform. target_space Target coordinate space: \"fsLR\" \"fsaverage\". target_density Target mesh density (e.g., \"32k\", \"164k\"). hemisphere hemispheres transform: \"left\", \"right\", . method Resampling method: \"adaptive\" (default) \"barycentric\". area_surf_current Path current-resolution area-correction surface (e.g. midthickness). Recommended method = \"adaptive\" proper vertex-area correction (matches neuromaps Python behaviour). area_surf_new Path target-resolution area-correction surface. NULL area_surf_current provided, ciftiTools resamples barycentrically. wb_path Path wb_command executable. NULL, auto-detected via ciftiTools. verbose Logical, print progress messages.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/transform_to_space.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform brain maps between coordinate spaces — transform_to_space","text":"Character vector transformed file paths.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/transform_to_space.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Transform brain maps between coordinate spaces — transform_to_space","text":"Robinson EC et al. (2014) NeuroImage 100:414-426. doi:10.1016/j.neuroimage.2014.07.033 Robinson EC et al. (2018) NeuroImage 167:150-165. doi:10.1016/j.neuroimage.2017.10.037","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/unparcellate.html","id":null,"dir":"Reference","previous_headings":"","what":"Unparcellate brain map data — unparcellate","title":"Unparcellate brain map data — unparcellate","text":"Inverse parcellate(): maps parcel-level values back vertices.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/unparcellate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unparcellate brain map data — unparcellate","text":"","code":"unparcellate(parcel_data, parcellation, fill = NA_real_)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/unparcellate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unparcellate brain map data — unparcellate","text":"parcel_data Named numeric vector parcel values. parcellation Integer vector labels file path GIFTI label file. fill Value medial wall vertices (default: NA_real_).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/unparcellate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unparcellate brain map data — unparcellate","text":"Numeric vector vertex-level values.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/unparcellate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Unparcellate brain map data — unparcellate","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertex_areas.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute per-vertex surface areas — vertex_areas","title":"Compute per-vertex surface areas — vertex_areas","text":"triangle distributes one-third area three vertices. Triangle area computed via cross-product formula.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertex_areas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute per-vertex surface areas — vertex_areas","text":"","code":"vertex_areas(vertices, faces)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertex_areas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute per-vertex surface areas — vertex_areas","text":"vertices Numeric matrix (n x 3) vertex coordinates. faces Integer matrix (m x 3) face indices (1-indexed).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertex_areas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute per-vertex surface areas — vertex_areas","text":"Numeric vector length nrow(vertices).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertices_to_parcels.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate vertex data into parcels — vertices_to_parcels","title":"Aggregate vertex data into parcels — vertices_to_parcels","text":"Summarises vertex-level data parcellation labels.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertices_to_parcels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate vertex data into parcels — vertices_to_parcels","text":"","code":"vertices_to_parcels(data, labels, summary_func = mean)"},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertices_to_parcels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate vertex data into parcels — vertices_to_parcels","text":"data Numeric vector vertex-level values. labels Integer vector parcel labels. 0 NA treated medial wall excluded. summary_func Function summarise parcel (default: mean).","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertices_to_parcels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate vertex data into parcels — vertices_to_parcels","text":"Named numeric vector parcel-level values.","code":""},{"path":"https://lcbc-uio.github.io/neuromapr/reference/vertices_to_parcels.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Aggregate vertex data into parcels — vertices_to_parcels","text":"Markello RD et al. (2022) Nature Methods 19:1472-1480. doi:10.1038/s41592-022-01625-w","code":""}]
